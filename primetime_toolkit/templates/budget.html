{% extends 'layout.html' %}

{% block content %}
<section class="hero-section text-center py-4">
  <div class="container">
    <h2>Upload your completed Excel Spreadsheet here</h2>
  </div>
</section>


<!--............... Still working on this .................-->
 <!-- .................................................... -->
  <!-- ....................................................-->


  <section class="upload-section text-center py-5">
  <div class="container">
    <div class="card mx-auto shadow-sm border-0 rounded-4 p-4" style="max-width: 500px;">
      <div class="card-body text-center">
        <span class="fs-1 text-primary mb-2"><i class="bi bi-upload"></i></span>
        <h6><strong>Upload Completed Spreadsheet</strong></h6><br>
        <form action="{{ url_for('views.upload_excel') }}" method="POST" enctype="multipart/form-data">
          <input type="file" name="budget_file" class="form-control mb-2 rounded-pill" accept=".xlsx,.xls" required>
          <button type="submit" class="btn btn-outline-primary rounded-pill px-4">Upload Spreadsheet</button>
        </form>
      </div>
    </div>
  </div>
</section>
<script>
  const dropArea = document.getElementById('drop-area');
  const fileInput = document.getElementById('budget-file-input');
  const fileNameDisplay = document.getElementById('file-name');

  dropArea.addEventListener('click', () => fileInput.click());

  dropArea.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropArea.classList.add('border-success');
  });

  dropArea.addEventListener('dragleave', () => {
    dropArea.classList.remove('border-success');
  });

  dropArea.addEventListener('drop', (e) => {
    e.preventDefault();
    dropArea.classList.remove('border-success');
    if (e.dataTransfer.files.length) {
      fileInput.files = e.dataTransfer.files;
      fileNameDisplay.textContent = e.dataTransfer.files[0].name;
    }
  });

  fileInput.addEventListener('change', () => {
    if (fileInput.files.length) {
      fileNameDisplay.textContent = fileInput.files[0].name;
    }
  });
</script>

</div>
{% endblock %}
